# Change Log: 2026-02-12 18:00

## Session Info
- **Type:** Feature
- **Request:** "Implement GitHub Release Auto-Update System"
- **Files Modified:** 3
- **Files Created:** 3
- **Files Deleted:** 0

---

## Changes Made

### 1. Version Constant
**What changed:**
- Created `version.py` with APP_VERSION="0.0.5", APP_NAME, GITHUB_REPO constants
- Separated from utils/constants.py to avoid side effects when imported by build script

**Files affected:**
- `version.py` (new)

### 2. Auto-Update Logic
**What changed:**
- Created `core/updater.py` with full update pipeline:
  - `check_for_update()` - Calls GitHub API `/repos/{REPO}/releases/latest`, compares semver
  - `download_update(url, progress_callback)` - Downloads zip to temp dir with progress
  - `apply_update(zip_path)` - Extracts zip, creates batch script for self-update
  - `_compare_versions(v1, v2)` - Simple semver comparison
- Batch script approach for Windows self-update (exe can't overwrite itself)
- Protected files list: bot_settings.json, config.json, region_settings.json
- Uses stdlib only (urllib, zipfile, subprocess) - no extra dependencies

**Files affected:**
- `core/updater.py` (new)

### 3. Update Dialog
**What changed:**
- Created `gui/dialogs/update_dialog.py` with UpdateDialog class
- Shows current vs new version, release notes (scrollable)
- Progress bar during download
- Buttons: "Update Now", "Skip This Version", "Remind Me Later"
- Download runs in background thread, progress via root.after()
- After download: apply_update → messagebox → parent.destroy()

**Files affected:**
- `gui/dialogs/update_dialog.py` (new)

### 4. Main Window Integration
**What changed:**
- Import APP_VERSION from version.py
- Title bar now shows version: "Uma Musume Auto Train v0.0.5 - ..."
- Added version label (v0.0.5, gray) under title text
- Added "Check Update" button in header settings_container
- Auto-checks for updates 2s after GUI init (background thread)
- `_manual_check_update()` shows "No Update" messagebox if already latest
- `_show_update_dialog()` creates UpdateDialog

**Files affected:**
- `gui/main_window.py`

### 5. Build Script Enhancement
**What changed:**
- Added `create_release_zip()` function - zips distribution folder into `Uma_Musume_Auto_Train_v{VERSION}.zip`
- Added to build_steps after create_distribution_package
- Updated build results to mention zip file for GitHub Releases upload

**Files affected:**
- `build_exe.py`

### 6. Dialog Package Export
**What changed:**
- Added UpdateDialog import and export in `gui/dialogs/__init__.py`

**Files affected:**
- `gui/dialogs/__init__.py`

---

## Testing Performed
- [ ] Run `python main.py` - GUI loads correctly
- [ ] Verify title bar shows version
- [ ] Click "Check Update" - should show "No Update" if no release exists
- [ ] Build with `python build_exe.py` - verify zip created

---

## Documentation Updates
- [x] Updated PROJECT_SUMMARY.md (sections 2, 4, 7)
- [x] Created history entry

---

## Known Issues / TODOs Added
- GitHub release must follow convention: tag=v0.0.5, asset=Uma_Musume_Auto_Train_v0.0.5.zip
- Zip must contain a single top-level folder (Uma_Musume_Auto_Train/)

---

## Notes
- Uses stdlib urllib instead of requests to keep updater lightweight
- Batch script saves protected files before copy and restores after (instead of xcopy exclude)
- version.py is intentionally at project root, not in utils/, to avoid importing heavy dependencies

---

**Status:** Completed
