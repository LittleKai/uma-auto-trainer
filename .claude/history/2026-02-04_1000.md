# Change Log - 2026-02-04 10:00

## Session Summary
Created comprehensive feature requirements document for implementing 4 new automation features using OpenCV instead of YOLO.

## Changes Made

### Files Created
- `.claude/FEATURE_REQUIREMENTS.md` - Detailed requirements for 4 new features

### Files Modified
- `.claude/PROJECT_SUMMARY.md` - Updated timestamp, added planned features, added recent changes entry

## Features Documented

### 1. Shop Preferences
- Auto-detect shop availability
- Template matching for shop button/items
- Color detection for exchange button
- UI: Checkbox + priority listbox

### 2. Skills to Buy
- OCR + fuzzy matching for skill names
- Color detection for buy button
- Scrolling skill list handling
- UI: Priority-ordered skill list

### 3. Race Scheduler Enhanced
- Template matching for grade badges (G1/G2/G3)
- Value-based race filtering
- Enhances existing race_handler.py
- UI: Value threshold, preferred races

### 4. Junior Style Selection (Debut)
- Template matching for style screen
- Color detection for style buttons
- OCR for style names (逃げ/先行/差し/追込)
- Character-based auto selection map
- UI: Style dropdown in Event Choice Tab

## Technical Decisions

### OpenCV over YOLO
- **Reason:** YOLO requires torch (~2GB) and high GPU requirements
- **Solution:** Template matching + color detection + existing OCR
- **Benefits:**
  - No additional heavy dependencies
  - Works on low-spec machines
  - Leverages existing OpenCV 4.12.0 infrastructure

### Implementation Approach
- Follow existing handler pattern with dependency injection
- Create new utility module `core/cv_utils.py` for common functions
- Add settings to existing `bot_settings.json`
- Integrate with existing bot flow in `core/execute.py`

## Recommended Implementation Order
1. Junior Style Selection (simplest)
2. Race Scheduler Enhancement (builds on existing)
3. Shop Preferences (medium complexity)
4. Skills to Buy (most complex)

## Context
- Referenced Umaplay project for detection patterns
- Adapted YOLO-based detection to OpenCV equivalents
- Documented for use in future Claude Code sessions

## Notes
- All coordinates assume 1920x1080 resolution
- Template images need to be captured from actual game
- Color ranges may need tuning based on game theme
